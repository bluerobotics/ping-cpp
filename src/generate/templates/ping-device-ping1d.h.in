/*
 * A device API for the Blue Robotics Ping Echosounder
 *
 *~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!
 * THIS IS AN AUTOGENERATED FILE
 * DO NOT EDIT
 *~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!
 *
 */

#pragma once

#include <ping-device.h>

class Ping1d : public PingDevice
{
public:
  /**
   *  @brief Constructor
   *
   *  @param ser: The device I/O
   */
  Ping1d(PingPort& port) : PingDevice(port) {}

  /**
   * @brief Destructor
   */
  ~Ping1d();

  /**
   *  @brief Establish communications with the device, and initialize the update interval
   *
   *  @param pingIntervalMs: The interval (in milliseconds) between acoustic measurements
   *
   *  @return true if the device was initialized successfully
   */
  bool initialize(uint16_t pingIntervalMs = 50);

{% for msg in messages["set"] %}
  /**
   * @brief {{messages["set"][msg].description}}
   *
{% for field in messages["set"][msg].payload %}
   * @param {{field.name}} - {% if field.units %}Units: {{field.units}}; {% endif %}{{field.description}}
{% endfor %}
   *
   * @return when verify = false: true if a valid reply is received from the device.
   * @return when verify = true: true if a valid reply is received from the
   * device, and the values in the reply match the values that we applied
   */
  bool {{msg}}({% for field in messages["set"][msg].payload %}{{generator.get_type_string(field.type)}} {{field.name}}, {% endfor %}bool verify = true);

{% endfor %}
{% set propnames=[] %}
{% set proplist=[] %}
{% for msg in messages["get"] %}
{% if not messages["get"][msg].deprecated %}
{% for field in messages["get"][msg].payload %}
{% if field.name not in propnames%}
{{ '' if propnames.append(field.name) -}}
{{ '' if proplist.append(field) -}}
{% endif %}
{% endfor %}
{% endif %}
{% endfor %}
{% for field in proplist %}
  // {{field.description}}
{% if generator.is_vector(field.type) %}
{% if field.vector.sizetype %}
  {{generator.get_type_string(field.vector.sizetype)}} {{field.name}}_length = 0;
{% endif %}
  {{generator.get_type_string(field.vector.datatype)}}* {{field.name}} = 0;
{% else %}
  {{generator.get_type_string(field.type)}} {{field.name}} = 0;
{% endif %}

{% endfor %}

private:
  /**
   *  @brief Handle an incoming message from the device. Internal values are updated according to the device data.
   *
   *  @param message: A pointer to the message received from the device
   */
  void _handleMessage(const ping_message* message) override;
};
